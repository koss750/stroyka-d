{"filter":false,"title":"GenerateExcel.php","tooltip":"/app/Nova/Actions/GenerateExcel.php","undoManager":{"mark":40,"position":40,"stack":[[{"start":{"row":0,"column":0},"end":{"row":39,"column":0},"action":"remove","lines":["<?php","","namespace App\\Nova\\Actions;","","use Illuminate\\Bus\\Queueable;","use Illuminate\\Contracts\\Queue\\ShouldQueue;","use Illuminate\\Queue\\InteractsWithQueue;","use Illuminate\\Support\\Collection;","use Laravel\\Nova\\Actions\\Action;","use Laravel\\Nova\\Fields\\ActionFields;","use Laravel\\Nova\\Http\\Requests\\NovaRequest;","","class GenerateExcel extends Action","{","    use InteractsWithQueue, Queueable;","","    /**","     * Perform the action on the given models.","     *","     * @param  \\Laravel\\Nova\\Fields\\ActionFields  $fields","     * @param  \\Illuminate\\Support\\Collection  $models","     * @return mixed","     */","    public function handle(ActionFields $fields, Collection $models)","    {","        //","    }","","    /**","     * Get the fields available on the action.","     *","     * @param  \\Laravel\\Nova\\Http\\Requests\\NovaRequest  $request","     * @return array","     */","    public function fields(NovaRequest $request)","    {","        return [];","    }","}",""],"id":2},{"start":{"row":0,"column":0},"end":{"row":96,"column":0},"action":"insert","lines":["<?php","","namespace App\\Nova\\Actions;","","use Illuminate\\Bus\\Queueable;","use Illuminate\\Contracts\\Queue\\ShouldQueue;","use Illuminate\\Queue\\InteractsWithQueue;","use Illuminate\\Support\\Collection;","use Laravel\\Nova\\Fields\\Select;","use Laravel\\Nova\\Actions\\Action;","use Laravel\\Nova\\Fields\\ActionFields;","use Laravel\\Nova\\Http\\Requests\\NovaRequest;","use Illuminate\\Support\\Facades\\Storage;","use App\\Http\\Controllers\\RuTranslationController as Translator;","","class GenerateExcel extends Action","{","    use InteractsWithQueue, Queueable;","","","    /**","     * Get the displayable name of the action.","     *","     * @return string","     */","    public function name()","    {","        return Translator::translate('foundation_action');","    }","    /**","     * Perform the action on the given models.","     *","     * @param  \\Laravel\\Nova\\Fields\\ActionFields  $fields","     * @param  \\Illuminate\\Support\\Collection  $models","     * @return mixed","     */","    public function handle(ActionFields $fields, Collection $models)","    {","        $sheetType = $fields->get('sheet_type');","    ","        if ($sheetType === 'foundation') {","            foreach ($models as $model) {","                $tapeWidth = $fields->get('tape_width');","                $fileName = $model->foundationExcel($tapeWidth);","                $filePath = '/storage/' . $fileName;","                //dd($filePath);","","                // After generating the file and saving it to $filePath","                // Return the download response using Nova's built-in DownloadResponse","                return Action::download($filePath, $fileName);","            }","        }","    ","        return Action::message('Excel file generated successfully!');","        ","    }","","","    public function fields(NovaRequest $request)","    {","        return [","            Select::make('Фундамент', 'sheet_type')","                ->options([","                    'foundation' => 'Ленточный',","                    // You can add more sheet types here in the future","                ])->help('Выберите тип фундамента')","                ->displayUsingLabels()","                ->help('Select the type of Excel sheet to generate'),","            Select::make('Сечения', 'tape_width')","                ->options([","                    '300x600' => '300x600',","                    '300x700' => '300x700',","                    '300x800' => '300x800',","                    '300x900' => '300x900',","                    '300x1000' => '300x1000',","                    '400x600' => '400x600',","                    '400x700' => '400x700',","                    '400x800' => '400x800',","                    '400x900' => '400x900',","                    '400x1000' => '400x1000',","                    '500x600' => '500x600',","                    '500x700' => '500x700',","                    '500x800' => '500x800',","                    '500x900' => '500x900',","                    '500x1000' => '500x1000',","                    '600x700' => '600x700',","                    '600x800' => '600x800',","                    '600x900' => '600x900',","                    '600x1000' => '600x1000',","                ])","                ->displayUsingLabels()","                ->sortable()","                ->help('Выберите ширину ленты')","        ];","    }","}",""]}],[{"start":{"row":43,"column":36},"end":{"row":43,"column":51},"action":"remove","lines":["foundationExcel"],"id":3},{"start":{"row":43,"column":36},"end":{"row":43,"column":56},"action":"insert","lines":["foundationLentaExcel"]}],[{"start":{"row":40,"column":38},"end":{"row":40,"column":39},"action":"insert","lines":["_"],"id":4},{"start":{"row":40,"column":39},"end":{"row":40,"column":40},"action":"insert","lines":["l"]},{"start":{"row":40,"column":40},"end":{"row":40,"column":41},"action":"insert","lines":["e"]},{"start":{"row":40,"column":41},"end":{"row":40,"column":42},"action":"insert","lines":["n"]},{"start":{"row":40,"column":42},"end":{"row":40,"column":43},"action":"insert","lines":["t"]},{"start":{"row":40,"column":43},"end":{"row":40,"column":44},"action":"insert","lines":["a"]}],[{"start":{"row":63,"column":31},"end":{"row":63,"column":32},"action":"insert","lines":["_"],"id":5},{"start":{"row":63,"column":32},"end":{"row":63,"column":33},"action":"insert","lines":["l"]},{"start":{"row":63,"column":33},"end":{"row":63,"column":34},"action":"insert","lines":["e"]},{"start":{"row":63,"column":34},"end":{"row":63,"column":35},"action":"insert","lines":["n"]},{"start":{"row":63,"column":35},"end":{"row":63,"column":36},"action":"insert","lines":["t"]},{"start":{"row":63,"column":36},"end":{"row":63,"column":37},"action":"insert","lines":["a"]}],[{"start":{"row":63,"column":31},"end":{"row":63,"column":32},"action":"remove","lines":["_"],"id":6},{"start":{"row":63,"column":30},"end":{"row":63,"column":31},"action":"remove","lines":["n"]},{"start":{"row":63,"column":29},"end":{"row":63,"column":30},"action":"remove","lines":["o"]},{"start":{"row":63,"column":28},"end":{"row":63,"column":29},"action":"remove","lines":["i"]},{"start":{"row":63,"column":27},"end":{"row":63,"column":28},"action":"remove","lines":["t"]},{"start":{"row":63,"column":26},"end":{"row":63,"column":27},"action":"remove","lines":["a"]},{"start":{"row":63,"column":25},"end":{"row":63,"column":26},"action":"remove","lines":["d"]},{"start":{"row":63,"column":24},"end":{"row":63,"column":25},"action":"remove","lines":["n"]},{"start":{"row":63,"column":23},"end":{"row":63,"column":24},"action":"remove","lines":["u"]},{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":["o"]},{"start":{"row":63,"column":21},"end":{"row":63,"column":22},"action":"remove","lines":["f"]}],[{"start":{"row":40,"column":29},"end":{"row":40,"column":39},"action":"remove","lines":["oundation_"],"id":7},{"start":{"row":40,"column":28},"end":{"row":40,"column":29},"action":"remove","lines":["f"]}],[{"start":{"row":40,"column":28},"end":{"row":40,"column":29},"action":"insert","lines":["f"],"id":8}],[{"start":{"row":40,"column":29},"end":{"row":40,"column":30},"action":"remove","lines":["l"],"id":9},{"start":{"row":40,"column":29},"end":{"row":40,"column":30},"action":"insert","lines":["L"]}],[{"start":{"row":63,"column":21},"end":{"row":63,"column":22},"action":"remove","lines":["l"],"id":10}],[{"start":{"row":63,"column":21},"end":{"row":63,"column":22},"action":"insert","lines":["f"],"id":11},{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":[":"]}],[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":[":"],"id":12}],[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["L"],"id":13}],[{"start":{"row":44,"column":38},"end":{"row":44,"column":39},"action":"insert","lines":["f"],"id":15}],[{"start":{"row":44,"column":39},"end":{"row":44,"column":40},"action":"insert","lines":["i"],"id":16},{"start":{"row":44,"column":40},"end":{"row":44,"column":41},"action":"insert","lines":["l"]},{"start":{"row":44,"column":41},"end":{"row":44,"column":42},"action":"insert","lines":["e"]},{"start":{"row":44,"column":42},"end":{"row":44,"column":43},"action":"insert","lines":["s"]},{"start":{"row":44,"column":43},"end":{"row":44,"column":44},"action":"insert","lines":["/"]}],[{"start":{"row":43,"column":21},"end":{"row":43,"column":25},"action":"remove","lines":["Name"],"id":17}],[{"start":{"row":43,"column":21},"end":{"row":43,"column":22},"action":"insert","lines":["P"],"id":18},{"start":{"row":43,"column":22},"end":{"row":43,"column":23},"action":"insert","lines":["a"]},{"start":{"row":43,"column":23},"end":{"row":43,"column":24},"action":"insert","lines":["t"]},{"start":{"row":43,"column":24},"end":{"row":43,"column":25},"action":"insert","lines":["h"]}],[{"start":{"row":43,"column":69},"end":{"row":44,"column":58},"action":"remove","lines":["","                $filePath = '/storage/files/' . $fileName;"],"id":19}],[{"start":{"row":43,"column":16},"end":{"row":43,"column":25},"action":"remove","lines":["$filePath"],"id":20},{"start":{"row":43,"column":16},"end":{"row":43,"column":17},"action":"insert","lines":["$"]}],[{"start":{"row":43,"column":17},"end":{"row":43,"column":18},"action":"insert","lines":["s"],"id":21},{"start":{"row":43,"column":18},"end":{"row":43,"column":19},"action":"insert","lines":["a"]},{"start":{"row":43,"column":19},"end":{"row":43,"column":20},"action":"insert","lines":["v"]},{"start":{"row":43,"column":20},"end":{"row":43,"column":21},"action":"insert","lines":["e"]}],[{"start":{"row":44,"column":16},"end":{"row":44,"column":32},"action":"remove","lines":["//dd($filePath);"],"id":22},{"start":{"row":44,"column":16},"end":{"row":44,"column":17},"action":"insert","lines":["$"]},{"start":{"row":44,"column":17},"end":{"row":44,"column":18},"action":"insert","lines":["f"]},{"start":{"row":44,"column":18},"end":{"row":44,"column":19},"action":"insert","lines":["i"]},{"start":{"row":44,"column":19},"end":{"row":44,"column":20},"action":"insert","lines":["l"]},{"start":{"row":44,"column":20},"end":{"row":44,"column":21},"action":"insert","lines":["e"]},{"start":{"row":44,"column":21},"end":{"row":44,"column":22},"action":"insert","lines":["P"]},{"start":{"row":44,"column":22},"end":{"row":44,"column":23},"action":"insert","lines":["a"]},{"start":{"row":44,"column":23},"end":{"row":44,"column":24},"action":"insert","lines":["t"]},{"start":{"row":44,"column":24},"end":{"row":44,"column":25},"action":"insert","lines":["h"]}],[{"start":{"row":44,"column":25},"end":{"row":44,"column":26},"action":"insert","lines":[" "],"id":23},{"start":{"row":44,"column":26},"end":{"row":44,"column":27},"action":"insert","lines":["="]}],[{"start":{"row":44,"column":27},"end":{"row":44,"column":28},"action":"insert","lines":[" "],"id":24},{"start":{"row":44,"column":28},"end":{"row":44,"column":29},"action":"insert","lines":["$"]},{"start":{"row":44,"column":29},"end":{"row":44,"column":30},"action":"insert","lines":["s"]},{"start":{"row":44,"column":30},"end":{"row":44,"column":31},"action":"insert","lines":["a"]},{"start":{"row":44,"column":31},"end":{"row":44,"column":32},"action":"insert","lines":["v"]},{"start":{"row":44,"column":32},"end":{"row":44,"column":33},"action":"insert","lines":["e"]}],[{"start":{"row":44,"column":33},"end":{"row":44,"column":35},"action":"insert","lines":["[]"],"id":25}],[{"start":{"row":44,"column":34},"end":{"row":44,"column":35},"action":"insert","lines":["0"],"id":26}],[{"start":{"row":44,"column":34},"end":{"row":44,"column":35},"action":"remove","lines":["0"],"id":27}],[{"start":{"row":44,"column":34},"end":{"row":44,"column":36},"action":"insert","lines":["\"\""],"id":28}],[{"start":{"row":44,"column":35},"end":{"row":44,"column":36},"action":"insert","lines":["f"],"id":29},{"start":{"row":44,"column":36},"end":{"row":44,"column":37},"action":"insert","lines":["i"]},{"start":{"row":44,"column":37},"end":{"row":44,"column":38},"action":"insert","lines":["l"]},{"start":{"row":44,"column":38},"end":{"row":44,"column":39},"action":"insert","lines":["e"]},{"start":{"row":44,"column":39},"end":{"row":44,"column":40},"action":"insert","lines":["P"]},{"start":{"row":44,"column":40},"end":{"row":44,"column":41},"action":"insert","lines":["a"]},{"start":{"row":44,"column":41},"end":{"row":44,"column":42},"action":"insert","lines":["t"]},{"start":{"row":44,"column":42},"end":{"row":44,"column":43},"action":"insert","lines":["h"]}],[{"start":{"row":44,"column":38},"end":{"row":44,"column":39},"action":"remove","lines":["e"],"id":30},{"start":{"row":44,"column":37},"end":{"row":44,"column":38},"action":"remove","lines":["l"]},{"start":{"row":44,"column":36},"end":{"row":44,"column":37},"action":"remove","lines":["i"]},{"start":{"row":44,"column":35},"end":{"row":44,"column":36},"action":"remove","lines":["f"]}],[{"start":{"row":44,"column":35},"end":{"row":44,"column":36},"action":"insert","lines":["p"],"id":31},{"start":{"row":44,"column":36},"end":{"row":44,"column":37},"action":"insert","lines":["u"]},{"start":{"row":44,"column":37},"end":{"row":44,"column":38},"action":"insert","lines":["b"]},{"start":{"row":44,"column":38},"end":{"row":44,"column":39},"action":"insert","lines":["l"]},{"start":{"row":44,"column":39},"end":{"row":44,"column":40},"action":"insert","lines":["i"]},{"start":{"row":44,"column":40},"end":{"row":44,"column":41},"action":"insert","lines":["c"]}],[{"start":{"row":44,"column":47},"end":{"row":44,"column":48},"action":"insert","lines":[";"],"id":32}],[{"start":{"row":44,"column":48},"end":{"row":45,"column":0},"action":"insert","lines":["",""],"id":33},{"start":{"row":45,"column":0},"end":{"row":45,"column":16},"action":"insert","lines":["                "]},{"start":{"row":45,"column":16},"end":{"row":45,"column":17},"action":"insert","lines":["$"]},{"start":{"row":45,"column":17},"end":{"row":45,"column":18},"action":"insert","lines":["f"]},{"start":{"row":45,"column":18},"end":{"row":45,"column":19},"action":"insert","lines":["i"]},{"start":{"row":45,"column":19},"end":{"row":45,"column":20},"action":"insert","lines":["l"]},{"start":{"row":45,"column":20},"end":{"row":45,"column":21},"action":"insert","lines":["e"]},{"start":{"row":45,"column":21},"end":{"row":45,"column":22},"action":"insert","lines":["N"]}],[{"start":{"row":45,"column":22},"end":{"row":45,"column":23},"action":"insert","lines":["a"],"id":34},{"start":{"row":45,"column":23},"end":{"row":45,"column":24},"action":"insert","lines":["m"]},{"start":{"row":45,"column":24},"end":{"row":45,"column":25},"action":"insert","lines":["e"]}],[{"start":{"row":45,"column":25},"end":{"row":45,"column":26},"action":"insert","lines":[" "],"id":35},{"start":{"row":45,"column":26},"end":{"row":45,"column":27},"action":"insert","lines":["="]}],[{"start":{"row":45,"column":27},"end":{"row":45,"column":28},"action":"insert","lines":[" "],"id":36},{"start":{"row":45,"column":28},"end":{"row":45,"column":29},"action":"insert","lines":["$"]},{"start":{"row":45,"column":29},"end":{"row":45,"column":30},"action":"insert","lines":["s"]},{"start":{"row":45,"column":30},"end":{"row":45,"column":31},"action":"insert","lines":["a"]},{"start":{"row":45,"column":31},"end":{"row":45,"column":32},"action":"insert","lines":["v"]},{"start":{"row":45,"column":32},"end":{"row":45,"column":33},"action":"insert","lines":["e"]},{"start":{"row":45,"column":33},"end":{"row":45,"column":34},"action":"insert","lines":["{"]}],[{"start":{"row":45,"column":33},"end":{"row":45,"column":34},"action":"remove","lines":["{"],"id":37}],[{"start":{"row":45,"column":33},"end":{"row":45,"column":35},"action":"insert","lines":["[]"],"id":38}],[{"start":{"row":45,"column":34},"end":{"row":45,"column":36},"action":"insert","lines":["\"\""],"id":39}],[{"start":{"row":45,"column":35},"end":{"row":45,"column":36},"action":"insert","lines":["p"],"id":40},{"start":{"row":45,"column":36},"end":{"row":45,"column":37},"action":"insert","lines":["u"]},{"start":{"row":45,"column":37},"end":{"row":45,"column":38},"action":"insert","lines":["b"]},{"start":{"row":45,"column":38},"end":{"row":45,"column":39},"action":"insert","lines":["l"]},{"start":{"row":45,"column":39},"end":{"row":45,"column":40},"action":"insert","lines":["i"]},{"start":{"row":45,"column":40},"end":{"row":45,"column":41},"action":"insert","lines":["c"]},{"start":{"row":45,"column":41},"end":{"row":45,"column":42},"action":"insert","lines":["N"]}],[{"start":{"row":45,"column":41},"end":{"row":45,"column":42},"action":"remove","lines":["N"],"id":41},{"start":{"row":45,"column":40},"end":{"row":45,"column":41},"action":"remove","lines":["c"]},{"start":{"row":45,"column":39},"end":{"row":45,"column":40},"action":"remove","lines":["i"]},{"start":{"row":45,"column":38},"end":{"row":45,"column":39},"action":"remove","lines":["l"]},{"start":{"row":45,"column":37},"end":{"row":45,"column":38},"action":"remove","lines":["b"]},{"start":{"row":45,"column":36},"end":{"row":45,"column":37},"action":"remove","lines":["u"]},{"start":{"row":45,"column":35},"end":{"row":45,"column":36},"action":"remove","lines":["p"]},{"start":{"row":45,"column":35},"end":{"row":45,"column":36},"action":"insert","lines":["f"]},{"start":{"row":45,"column":36},"end":{"row":45,"column":37},"action":"insert","lines":["i"]},{"start":{"row":45,"column":37},"end":{"row":45,"column":38},"action":"insert","lines":["l"]},{"start":{"row":45,"column":38},"end":{"row":45,"column":39},"action":"insert","lines":["e"]}],[{"start":{"row":45,"column":39},"end":{"row":45,"column":40},"action":"insert","lines":["N"],"id":42},{"start":{"row":45,"column":40},"end":{"row":45,"column":41},"action":"insert","lines":["a"]},{"start":{"row":45,"column":41},"end":{"row":45,"column":42},"action":"insert","lines":["m"]},{"start":{"row":45,"column":42},"end":{"row":45,"column":43},"action":"insert","lines":["e"]}],[{"start":{"row":45,"column":45},"end":{"row":45,"column":46},"action":"insert","lines":[";"],"id":43}]]},"ace":{"folds":[],"scrolltop":430.2000000000001,"scrollleft":0,"selection":{"start":{"row":46,"column":0},"end":{"row":46,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1706320909001,"hash":"85f857595927570f4e2082fdadfa72e5e71c02c3"}